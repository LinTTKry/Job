# CDN/DNS

CDN 缓存介绍（Content Delivery Network）

当服务接入了 CDN 之后，浏览器本地缓存的资源过期之后，浏览器不是直接向源服务器请求资源，而是转而向 CDN 边缘节点请求资源。CDN 边缘节点中将用户的数据缓存起来，如果 CDN 中的缓存也过期了，CDN 边缘节点会向源服务器发出回源请求，从而来获取最新资源.

### **CDN工作原理**

CDN做了两件事，一是让用户访问最近的节点，二是从缓存或者源站获取资源

CDN的工作原理：通过dns服务器来实现优质节点的选择，通过缓存来减少源站的压力。

### DNS(Domain Name System, 域名系统)，是域名和IP地址相互映射的一个分布式数据库

当浏览器访问一个域名的时候，需要解析一次DNS，获得对应域名的ip地址。在解析过程中，按照浏览器缓存、系统缓存、路由器缓存、ISP(运营商)DNS缓存、根域名服务器、顶级域名服务器、主域名服务器的顺序，逐步读取缓存，直到拿到IP地址.

### 递归查询与迭代查询

&#x20;一、主机向本地域名服务器的查询一般都是采用递归查询。

&#x20;       所谓递归查询就是：如果主机所询问的本地域名服务器不知道被查询的域名的IP地址，那么本地域名服务器就以DNS客户的身份，向其它根域名服务器继续发出查询请求报文(即替主机继续查询)，而不是让主机自己进行下一步查询。因此，递归查询返回的查询结果或者是所要查询的IP地址，或者是报错，表示无法查询到所需的IP地址。

二、本地域名服务器向根域名服务器的查询的迭代查询。

&#x20;      迭代查询的特点：当根域名服务器收到本地域名服务器发出的迭代查询请求报文时，要么给出所要查询的IP地址，要么告诉本地服务器：“你下一步应当向哪一个域名服务器进行查询”。 然后让本地服务器进行后续的查询。根域名服务器通常是把自己知道的顶级域名服务器的IP地址告诉本地域名服务器，让本地域名服务器再向顶级域名服务器查询。

&#x20;       顶级域名服务器在收到本地域名服务器的查询请求后，要么给出所要查询的IP地址，要么告诉本地服务器下一步应当向哪一个权限域名服务器进行查询。

&#x20;       最后，知道了所要解析的IP地址或报错，然后把这个结果返回给发起查询的主机

1.域名系统

![](https://images2017.cnblogs.com/blog/858807/201708/858807-20170820123427006-190298208.png)

![](https://images2017.cnblogs.com/blog/858807/201708/858807-20170820123443521-1502085421.png)

&#x20;2.域名服务器

![](https://images2017.cnblogs.com/blog/858807/201708/858807-20170820123624303-680937649.png)
