# Chrome浏览器架构

## 进程 vs 线程

多线程可以并行处理任务，但是线程是不能单独存在的，它是由进程来启动和管理的。

<mark style="color:blue;">**一个进程就是一个程序的运行实例**</mark>。详细解释就是**，启动一个程序的时候，操作系统会为该程序创建一块内存，用来存放代码、运行中的数据和一个执行任务的主线程，我们把这样的一个运行环境叫进程**。

![](<../.gitbook/assets/image (6) (1).png>)

线程是依附于进程的，而进程中使用多线程并行处理能提升运算效率。

1. **进程中的任意一线程执行出错，都会导致整个进程的崩溃**。
2. **线程之间共享进程中的数据**：线程之间可以对进程的**公共数据**进行读写操作
3. **当一个进程关闭之后，操作系统会回收进程所占用的内存**
4. 进**程之间的内容相互隔离**，如果进程之间需要进行数据的通信，这时候，就需要使用用于**进程间通信（IPC）的机制**了

仅仅打开了 1 个页面，为什么有 4 个进程？因为打开 1 个页面至少需要 1 个网络进程、1 个浏览器进程、1 个 GPU 进程以及 1 个渲染进程，共 4 个；如果打开的页面有运行插件的话，还需要再加上 1 个插件进程。

## <mark style="color:red;">目前多进程架构</mark>

​![](<../.gitbook/assets/image (62) (1) (1) (1).png>)

* **浏览器进程。**主要负责<mark style="color:red;">**界面显示、用户交互、子进程管理**</mark>，同时提供存储等功能。
* **渲染进程**。核心任务是将 ** **<mark style="color:red;">**HTML、CSS 和 JavaScript 转换为用户可以与之交互的网页**</mark>，排版引擎 Blink 和 JavaScript 引擎 V8 都是运行在该进程中，默认情况下，Chrome 会为每个 Tab 标签创建一个渲染进程。出于安全考虑，<mark style="color:red;">**渲染进程都是运行在沙箱模式**</mark>下。
* **GPU 进程**。其实，Chrome 刚开始发布的时候是没有 GPU 进程的。而 GPU 的使用初衷是为了实现 3D CSS 的效果，只是随后网页、<mark style="color:red;">**Chrome 的 UI 界面都选择采用 GPU 来绘制**</mark>，这使得 GPU 成为浏览器普遍的需求。最后，Chrome 在其多进程架构上也引入了 GPU 进程。
* **网络进程。**主要<mark style="color:red;">**负责页面的网络资源加载**</mark>，之前是作为一个模块运行在浏览器进程里面的，直至最近才独立出来，成为一个单独的进程。
* **插件进程。**主要是负责插件的运行，因插件易崩溃，所以需要通过插件进程来隔离，以保证插件进程崩溃不会对浏览器和页面造成影响。
