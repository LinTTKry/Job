# https

## https安全通信

在TCP建立连接之后，还有一个SSL的秘钥协商过程：

1.客户端请求证书并验证

2.验证通过后，就随机生成一个秘钥，并且通过公钥发送给服务端

3.服务端通过私钥解密客户端发送过来的秘钥

4.双方通过对称加密即相同秘钥来加密解密传输的数据。

## https非安全通信

对称加密的密钥使⽤⾮对称加密的公钥进⾏加密，然后发送出去，接收⽅使⽤私钥进⾏解密得到对称加密的密钥，然后双⽅可以使⽤对称加密来进⾏沟通。

## 非安全存在的问题

如果此时在客户端和服务器之间存在⼀个中间⼈,这个中间⼈只需要把原本双⽅通信互发的公钥,换成⾃⼰的公钥,这样中 间⼈就可以轻松解密通信双⽅所发送的所有数据

## 中间人攻击具体过程

介绍下HTTPS 中间人攻击 https 协议由http + ssl 协议构成，具体的链接过程可参考SSL 或TLS 握手的概 述 中间人攻击过程如下：&#x20;

1\. 服务器向客户端发送公钥。

&#x20;2\. 攻击者截获公钥，保留在自己手上。&#x20;

3\. 然后攻击者自己生成一个【伪造的】公钥，发给客户端。&#x20;

4\. 客户端收到伪造的公钥后，生成加密hash 值发给服务器。&#x20;

5\. 攻击者获得加密hash 值，用自己的私钥解密获得真秘钥。&#x20;

6\. 同时生成假的加密hash 值，发给服务器。

&#x20;7\. 服务器用私钥解密获得假秘钥。

&#x20;服务器用加秘钥加密传输信息 防范方法： 服务端在发送浏览器的公钥中加入CA 证书，浏览器可以验证CA 证书的有效性
