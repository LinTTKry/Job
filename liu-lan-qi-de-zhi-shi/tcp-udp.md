# TCP/UDP

| UDP                                                               | TCP                                                                                  |
| ----------------------------------------------------------------- | ------------------------------------------------------------------------------------ |
| 面向无连接                                                             | 面向连接                                                                                 |
| 1对多，多对多                                                           | 1对1，全双工                                                                              |
| <p>尽最大努力交付，没有重传机制</p><p>不保证可靠性与有序性</p>                            | 保证数据的可靠性以及有序性                                                                        |
| 不能流量控制来避免网络堵塞                                                     | 通过流量控制来避免阻塞                                                                          |
| 传输速率较快                                                            | 传输速率较慢                                                                               |
| <p>应用场景：</p><p>数据包数量较少的通信，</p><p>视频语音对实时性要求</p><p>较高的通信，广播，多播</p> | <p>1.浏览器使用的：HTTP </p><p>2.FlashFXP:FTP </p><p>3.Outlook:POP，SMTP </p><p>4.QQ文件传输</p> |

### **TCP 协议如何保证可靠传输（TCP通过序列号、检验和、确认应答信号、重发控制、连接管理、窗口控制、流量控制、拥塞控制实现可靠性）**

* 应用数据被分割成 TCP 认为最适合发送的数据块。
* TCP 给发送的每一个包进行编号，接收方对数据包进行排序，把有序数据传送给应用层。
* &#x20;校验和： TCP 将保持它首部和数据的检验和。这是一个端到端的检验和，目的是检测数据在传输过程中的任何变化。如果收到段的检验和有差错，TCP 将丢弃这个报文段和不确认收到此报文段。
* TCP 的接收端会丢弃重复的数据。
*   &#x20;**流量控制**： 1：TCP 利用滑动窗口实现流量控制。

    *   &#x20;             2： 流量控制是为了控制发送方发送速率，保证接收方来得及接收。&#x20;

        &#x20;             3：接收方发送的确认报文中的窗口字段可以用来控制发送方窗口大小，从而影响发送方的发送速率。

    &#x20;                     4：将窗口字段设置为 0，则发送方不能发送数据。
* &#x20;**拥塞控制**： 当网络拥塞时，减少数据的发送。拥塞控制是一个全局性的过程，涉及到所有的主机，所有的路由器，以及与降低网络传输性能有关的所有因素。相反，流量控制往往是点对点通信量的控制，是个端到端的问题。**TCP 发送方要维持一个 拥塞窗口(cwnd) 的状态变量。拥塞控制窗口的大小取决于网络的拥塞程度，并且动态变化。发送方让自己的发送窗口取为拥塞窗口和接收方的接受窗口中较小的一个**
  * &#x20;             1：**慢开始**：在启动初期以指数增长方式增长；设置一个慢启动的阈值，当以指数增长达到阈值时就停止指数增长，按照线性增长方式增加至拥塞窗口；线性增长达到网络拥塞时立即把拥塞窗口置回1，进行新一轮的“慢启动”，同时新一轮的阈值变为原来的一半。
  *   &#x20;             2： **拥塞避免**： 拥塞避免算法的思路是让拥塞窗口cwnd缓慢增大，即每经过一个往返时间RTT就把发送放的cwnd加1.

      &#x20;             3： **快重传与快恢复：**有了 FRR，如果接收机接收到一个不按顺序的数据段，它会立即给发送机发送一个重复确认。如果发送机接收到三个重复确认，它会假定确认件指出的数据段丢失了，并立即重传这些丢失的数据段。有了 FRR，就不会因为重传时要求的暂停被耽误。 当有单独的数据包丢失时，快速重传和恢复（FRR）能最有效地工作。当有多个数据信息包在某一段很短的时间内丢失时，它则不能很有效地工作。

![](<../.gitbook/assets/image (11).png>)



* &#x20;**停止等待协议**: 也是为了实现可靠传输的，它的基本原理就是每发完一个分组就- 停止发送，等待对方确认。在收到确认后再发下一个分组。 超时重传： 当 TCP 发出一个段后，它启动一个定时器，等待目的端确认收到这个报文段。如果不能及时收到一个确认，将重发这个报文段。
